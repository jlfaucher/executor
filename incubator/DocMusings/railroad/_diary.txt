===============================================================================
2009 june 28

About Clapham :
http://julianhyde.blogspot.com/2009/05/clapham-railroad-diagram-generator.html
In the comments :
<<
Tom Copeland said...
Also, FWIW, Eric Dahlstrom saw this and tweeted "that svg output is not very pretty, 
suggest using either svg paths or rects directly, and to make sure text is placed correctly". 
Probably the "use paths or rects" means more to you than it does to me :-)
>>


Other investigation :
http://dita.xml.org/wiki/plugins-for-the-dita-open-toolkit
--> downloaded the "Plus" plugins from
http://tech.groups.yahoo.com/group/dita-users/files/Demos/
This set of plug-ins for Dita contains a plug-in that can work alone :
com.moldflow.dita.syntaxdiagram2svg
Extract from its doc :
<<
This plugin is not strictly part of the Plus plugins, though it was developed in parallel
with them.  It is possible to use this plugin independently in your own transformation
by importing the XSLT template <filepath>xsl/syntaxdiagram2svg.xsl
>>
--> I had to modify a lot of things in this stylesheet (mechanical changes : had to replace
the tests contains(@class,...)  by name()=
Now I have something working (SVG output) but I can't visualize it... 
According to Deborah Picket (http://tech.groups.yahoo.com/group/dita-users/message/12082) :
<< 
You need a JavaScript-aware SVG renderer (I use Batik) to dynamically size the syntax diagram
to envelop the text that each box contains 
>>
--> so I downloaded Batik...
The file js/constants.js is missing.
Ok, this file is generated by transforming resource/constants.xml using xsl/make-constants.xsl.
Now it works, and the look is great.

I see that <fragment> does not work.
Probably because the search algorithm is based on <topic>, that I don't have in the raw syntax diagram.
--> fixed, now we have the referencing box, but no referenced diagram...
--> fixed, fragments are now generated as separate SVG files.

Is it possible to reuse the best of Clapham and syntaxdiagram2svg ?
The XML file read by syntaxdiagram2svg is diffcult to enter by hand, but the output is great.
The BNF or WSN files supported by Clapham are lot easier to enter by hand, but the output is not very pretty.
What about generating the XML file from the BNF|WSN ?


===============================================================================
2009 june 27

Found a reference to Clapham on reddit, and decided to have a look...

Output is not perfect, but that's a start...
I'm curious to see if I can modify this generator to :
- remove the boxes
- remove the title, to keep only the railroad
- have optional elements under the main line
- fix this bug : when last node is optional, it's inserted twice
(2009 june 28 : I give up these tasks... The output of com.moldflow.dita.syntaxdiagram2svg is far better !)

Clapham supports two dialects, so I test both.

Comments /* */ are not supported by the wsn parser.
--> cloned what's done in the bnf parser
Had to install javacc
and to replace javacc.jar (downloaded by Clapham) by the latest version from javacc
